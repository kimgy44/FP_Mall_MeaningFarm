<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mybatis.mapper.MemProductMapper">
	<!-- 01. 상품 전체목록 조회  -->
	<select id="memproductList" parameterType="java.util.Map" resultType="map">
		SELECT p.product_no, p.product_name, p.product_price, p.product_detail
		     , p.product_stock, p.product_img, p.product_dlvyfee, p.option_no
		     , p.category_local_no, p.category_type_no, p.m_id
		     , pf.productfile_name, NVL(pf.productfile_size,0), pf.productfile_path
		  FROM product p LEFT OUTER JOIN productfile pf
		    ON p.product_no = pf.product_no
		<where>
			<if test="product_no>0">
				AND p.product_no = #{product_no}
			</if>
		</where>  
		ORDER BY p.product_no ASC
		
	</select> 
	
	<!-- 02. 상품 전체목록 조회 및 페이징  -->
	<select id="memproductListpagin" parameterType="java.util.Map" resultType="map">
		<![CDATA[
		SELECT rnum, product_no, product_name,product_price, product_detail
		    	, product_stock, product_img, product_dlvyfee, option_no
		    	, category_local_no, category_type_no,m_id
		 FROM(
			   SELECT 
			    	/*+ INDEX_ASC(product pk_product) */
			             ROWNUM rnum, product_no, product_name,product_price, product_detail
			           , product_stock, product_img, product_dlvyfee, option_no
			           , category_local_no, category_type_no,m_id
			     FROM product
			    WHERE ROWNUM <= 10 #{pageNum} * #{amount}
		) WHERE rnum > (#{pageNum)-1) * #{amount} 
		
		]]>
	</select> 

</mapper>